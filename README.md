typescript version of:

http://mrale.ph/blog/2012/06/03/explaining-js-vms-in-js-inline-caches.html